# Kafka

# 구성

## Source

- 카프카에 데이터 전송
- 데이터의 포맷이 자유로움
- 이러한 구성을 Producer라고 함

## Target

- 카프카에 저장된 데이터 로딩
- 이러한 구성을 Consumer라고 함

## Kafka

- Source와 Target 사이의 커플링을 느슨하게 하는 역할
- Topic의 형태로 데이터를 저장
- 카프카는 큐의 형태로 토픽을 저장함
- 고가용성
    - 서버가 죽어도 데이터를 손실없이 복구 가능
    - 낮은 지연과 높은 처리량을 가짐

### Topic

- 큐(카프카)에 여러 토픽 저장 가능
    - DB의 테이블 역할
    - 이름을 가질 수 있음
        - 목적에 따라 어떤 데이터를 저장하는지 명확하게 명시하면 관리하기 편함
    - 토픽은 여러 Partion을 가질 수 있음
        - 파티션에 데이터가 순차적으로 적재됨
        - 적재된 데이터는 컨슈머가 적재가 오래된 순으로 읽어나감
        - 컨슈머가 모든 데이터를 읽었다면 새로운 데이터가 들어올 때까지 기다림
            - 이때 파티션의 데이터는 삭제되지 않음
            - 새로운 컨슈머가 생기면 다시 오래된 순서대로 읽어나감
                - 이때 컨슈머의 그룹은 달라야 함
                    - 그룹 = 목적
    - 파티션은 생성할 수 있지만 삭제할 수는 없기 때문에 신중해야 함
        - 파티션을 늘리는 이유는 컨슈머를 할당시켜 데이터를 분산처리하기 위함
        - 데이터를 파티션에 저장하는 방법은 일반적으로 라운드-로빈 형식으로 저장함
            - 라운드-로빈
                - 순차적으로 배정하는 방법
            - 특정 파티션에 저장하기 위해서는 키 값을 지정함
            - 키 값을 지정하지 않으면 라운드-로빈의 형태로 저장됨
